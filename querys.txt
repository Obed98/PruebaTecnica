

-----------QUERY 1
SELECT B.NOMBRE AS CLIENTE, TO_CHAR(A.FECHA,'MM-YYYY'), A.MONEDA_ID, SUM(A.TOTAL) AS CONSUMO
FROM ORDEN A
INNER JOIN CLIENTE B ON A.CLIENTE_ID = B.CLIENTE_ID
WHERE B.CLIENTE_ID = ID_BUSCADO
GROUP BY B.NOMBRE, A.MONEDA_ID, TO_CHAR(A.FECHA,'MM-YYYY')



---------QUERY 2
SELECT C.NOMBRE, MAX(SUM(B.CANTIDAD)) AS UNIDADES_DESPACHADAS
FROM ORDEN A
INNER JOIN DETALLE B ON A.ORDEN_ID = B.ORDEN_ID
INNER JOIN PRODUCTO C ON B.PRODUCTO_ID = C.PRODUCTO_ID
WHERE TO_CHAR(A.FECHA,'YYYY') = AÃ‘O_BUSCADO
GROUP BY C.NOMBRE